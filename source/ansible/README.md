# Ansible

Прежде всего, стоит отметить, что данный репозиторий рассчитан на опытных пользователей, которые немного смыслят в ansible или готовы начать изучать его базовые концепты.

## hosts.yml, host_vars

Здесь заданы переменные моего инвентаря. 

1. **real_system** - localhost, реальный компьютер ;

2. **control_node** - docker-машинка, которая собирается в роли ***docker_control_node***. 

   *Dockerfile*, *docker-compose.yml*, *.env* генерируются из ansible переменных. Необходима для тестирования.

   Чтобы управлять узлами, версия их python должна соответствовать некоторой версии ansible. Если **real_system** имеет устаревшую или неподходящую версию ansible, можно воспользоваться **control_node**. Эту docker-машинку легко модифицировать. Достаточно изменить базовый образ (по умолчанию *FROM ubuntu:jammy*), из которой она строится. Соответственно, изменятся и репозитории, из которых устанавливается ansible (=> его версия). Для удобства в контейнер монтируется том с репозиторием из **real_system**, а к самой машинке можно подключиться через ssh.

3. **virtual_box** - группа хостов, на которых применяются тестовые изменения. Необходима для тестирования. Virtualbox удобен тем, что легко откатывать изменения.

Итого, конечная цель - применение различных playbook-ов на **real_system**, который будет представлять собой чистую систему LM 21.2. А после применения - настроенную под меня систему. Для этого на LM 21.2 будет установлен ansible и применены playbook-и на саму систему. Однако на данный момент мой **real_system** - LM 19.3 со старым ansible, а playbook-и не готовы. Поэтому используется **control_node** как управляющий узел и **virtual_box** как тестовые узлы.

> Примечание:
>
> В общем случаи, для настройки инвентаря Вам понадобится лишь изменить свой **real_system**, т.е. указать **ansible_user**, **ansible_port**, **ansible_become_pass**, возможно, **ansible_python_interpreter** . Однако, если Вы планируете сделать собственные наработки на основе этого репозитория, вероятно, придется разобрать в ansible и docker хотя бы на базовом уровне.